# Lighthouse Checker

## Описание

Этот скрипт позволяет автоматизировать проверку производительности веб-страниц с помощью API Google PageSpeed Insights. Он отправляет запросы к API для указанных сайтов, собирает основные метрики производительности, такие как **FCP**, **LCP**, **TBT**, **CLS**, **TTFB**, **INP**, а также **общий балл производительности (Score)**. Скрипт многократно проверяет каждую страницу и сохраняет результаты в файле Excel.

Скрипт также добавляет:
- Цветовое форматирование в Excel для отображения допустимых, средних и критических значений.
- Приведение всех метрик к правильным единицам измерения.
- Расчет средних значений по каждой проверенной странице.

## Основные возможности

- Многократная проверка веб-страниц (по умолчанию 10 проверок для каждой страницы).
- Получение ключевых метрик: **FCP**, **LCP**, **SI**, **TBT**, **CLS**, **TTFB**, **INP** и **Score**.
- Автоматическое сохранение данных в формате Excel с форматированием и расчетом средних значений.
- Цветовая заливка ячеек для каждой метрики:
  - **Зелёный**: допустимые значения.
  - **Оранжевый**: средние значения.
  - **Красный**: критические значения.

## Требования

- Python 3.x
- Библиотеки:
  - `requests`
  - `pandas`
  - `openpyxl`
  - `tqdm`

Установить необходимые зависимости можно с помощью команды:
```bash
pip install requests pandas openpyxl tqdm
```

## Как пользоваться

1. Получите API-ключ для Google PageSpeed Insights:
   - Перейдите в [Google Cloud Console](https://console.cloud.google.com/), создайте проект и получите API-ключ для [PageSpeed Insights API](https://developers.google.com/speed/docs/insights/v5/get-started?hl=ru).
   
2. Подготовьте файл со списком сайтов:
   - Создайте файл `site.txt`, в который добавьте URL-адреса сайтов, по одному на строку. Пример:
   ```
   https://example.com
   https://another-example.com
   ```

3. Запустите скрипт:
   - Укажите API-ключ в скрипте (в переменной `API_KEY`).
   - Запустите скрипт:
   ```bash
   python main.py
   ```

4. После завершения работы скрипта:
   - Результаты будут сохранены в файле Excel (`results.xlsx`), который содержит:
     - Лист **"Проверка страниц"**: отображает все проведенные проверки для каждого сайта и устройства (десктоп и мобильный).
     - Лист **"Среднее значение"**: содержит средние значения метрик для каждого сайта и устройства.
     - Цветовое форматирование для удобства анализа значений.

## Примечания

- Если в метрике указано значение `NaN` или `0`, это может означать, что API не смог корректно собрать данные для этой метрики.
- В некоторых случаях метрика **INP** может отсутствовать, так как она экспериментальная и не всегда доступна в ответах API.
